Bootstrap: docker
From: ubuntu:22.04
Stage: spython-base

%post
# -*- Dockerfile -*-

useradd -u 1000 -ms /bin/bash must

DEBIAN_FRONTEND=noninteractive
TZ=Europe/Berlin

apt-get update \
&& apt-get -y -qq --no-install-recommends install \
cmake \
make \
openmpi-bin \
libopenmpi-dev \
libxml2-dev \
python3 \
python3-pip \
libdw-dev \
gfortran \
gcc \
g++ \
git \
graphviz \
libgtest-dev \
llvm-12-tools \
llvm-12-dev \
python2 \
&& apt-get -yq clean \
&& rm --recursive --force /var/lib/apt/lists/* \
&& pip3 install --no-input --no-cache-dir --disable-pip-version-check 'lit>=14.0.0'


su -  must # USER must
mkdir -p /home/must/src
mkdir -p /home/must/src
cd /home/must/src
%environment
export DEBIAN_FRONTEND=noninteractive
export TZ=Europe/Berlin
%runscript
cd /home/must/src
exec /bin/bash "$@"
%startscript
cd /home/must/src
exec /bin/bash "$@"

